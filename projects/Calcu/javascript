const current = document.getElementById("current");
const previous = document.getElementById("previous");
const buttons = document.querySelectorAll("button");

let currentValue = "0";
let previousValue = "";
let operator = null;
let resetNext = false;

function updateDisplay() {
    current.innerText = currentValue;
    previous.innerText = operator ? `${previousValue} ${operator}` : "";
}

buttons.forEach(btn => {
    btn.addEventListener("click", () => {
        const value = btn.innerText;

        if (!isNaN(value) || value === ".") {
            if (currentValue === "0" || resetNext) {
                currentValue = value === "." ? "0." : value;
                resetNext = false;
            } else {
                if (value === "." && currentValue.includes(".")) return;
                currentValue += value;
            }
            updateDisplay();
            return;
        }

        if (value === "AC") {
            currentValue = "0";
            previousValue = "";
            operator = null;
            updateDisplay();
            return;
        }

        if (value === "=") {
            if (!operator) return;
            calculate();
            operator = null;
            previousValue = "";
            resetNext = true;
            updateDisplay();
            return;
        }

        // Operator handling
        if (["+", "−", "×", "÷"].includes(value)) {
            if (operator) calculate();
            operator = value;
            previousValue = currentValue;
            resetNext = true;
            updateDisplay();
        }
    });
});

function calculate() {
    const prev = parseFloat(previousValue);
    const curr = parseFloat(currentValue);

    let result;
    switch (operator) {
        case "+": result = prev + curr; break;
        case "−": result = prev - curr; break;
        case "×": result = prev * curr; break;
        case "÷":
            if (curr === 0) {
                currentValue = "Error";
                return;
            }
            result = prev / curr;
            break;
    }

    currentValue = result.toString();
}
