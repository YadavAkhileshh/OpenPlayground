/* 
 * Mini Settings Panel - Main Stylesheet
 * -------------------------------------
 * Handles layout, components, and responsive behavior.
 * Depends on variables.css.
 */

/* =========================================
   1. RESET & BASE
   ========================================= */
*,
*::before,
*::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    /* Smooth transitions for all theme changes */
    transition: background-color var(--duration-norm) var(--ease-out),
        border-color var(--duration-norm) var(--ease-out),
        color var(--duration-norm) var(--ease-out),
        box-shadow var(--duration-norm) var(--ease-out);
}

body {
    font-family: var(--font-family-primary);
    background-color: var(--bg-app);
    background-image: linear-gradient(to bottom right, var(--bg-app), var(--slate-200));
    /* Subtle depth */
    color: var(--text-primary);
    line-height: 1.5;
    font-size: var(--fs-base);
    height: 100vh;
    overflow: hidden;
    /* App container handles scroll */

    /* Premium Text Rendering */
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

[data-theme="dark"] body {
    background-image: linear-gradient(to bottom right, var(--bg-app), #020617);
}

ul {
    list-style: none;
}

button {
    background: none;
    border: none;
    cursor: pointer;
    font: inherit;
    color: inherit;
}

/* =========================================
   2. APP LAYOUT
   ========================================= */
.app-container {
    display: flex;
    height: 100%;
    width: 100%;
    position: relative;
    max-width: 1920px;
    margin: 0 auto;
    background-color: var(--bg-app);
}

/* Sidebar */
.sidebar {
    width: var(--sidebar-width);
    background-color: var(--bg-sidebar);
    border-right: 1px solid var(--sidebar-border);
    display: flex;
    flex-direction: column;
    padding: var(--space-4);
    transition: transform var(--duration-norm) var(--ease-in-out);
    z-index: 100;
}

.sidebar-header {
    margin-bottom: var(--space-8);
    padding: 0 var(--space-2);
}

.logo-container {
    display: flex;
    align-items: center;
    gap: var(--space-3);
}

.logo-icon {
    width: 32px;
    height: 32px;
    background: linear-gradient(135deg, var(--brand-500), var(--brand-700));
    border-radius: var(--radius-md);
    box-shadow: 0 2px 4px rgba(99, 102, 241, 0.3);
}

.logo-text {
    font-size: var(--fs-xl);
    font-weight: var(--fw-bold);
    color: var(--text-primary);
    letter-spacing: -0.02em;
}

/* Nav */
.sidebar-nav {
    flex: 1;
    overflow-y: auto;
}

.nav-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
}

.nav-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3) var(--space-4);
    border-radius: var(--radius-md);
    color: var(--text-secondary);
    font-weight: var(--fw-medium);
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-out);
}

.nav-item:hover {
    background-color: var(--nav-item-hover);
    color: var(--text-primary);
}

.nav-item.active {
    background-color: var(--nav-item-active-bg);
    color: var(--nav-item-active-text);
}

.nav-icon {
    width: 20px;
    height: 20px;
    background-color: currentColor;
    /* Placeholder for icon SVG */
    mask-size: contain;
    mask-position: center;
    mask-repeat: no-repeat;
    opacity: 0.8;
}

/* User Profile Preview */
.user-profile-preview {
    margin-top: auto;
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3);
    border-top: 1px solid var(--sidebar-border);
}

.avatar {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    background-color: var(--brand-200);
    border: 2px solid var(--bg-sidebar);
}

.user-info {
    display: flex;
    flex-direction: column;
}

.user-name {
    font-size: var(--fs-sm);
    font-weight: var(--fw-semibold);
    color: var(--text-primary);
}

.user-role {
    font-size: var(--fs-xs);
    color: var(--text-tertiary);
}

/* Main Content */
.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-width: 0;
    /* Prevent flex overflow */
    position: relative;
    background-color: var(--bg-app);
}

/* Top Bar */
.top-bar {
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 var(--space-8);
    background-color: transparent;
    /* Makes it feel airy */
    flex-shrink: 0;
}

.mobile-menu-toggle {
    display: none;
    /* Hidden on desktop */
    flex-direction: column;
    justify-content: space-between;
    width: 24px;
    height: 18px;
    margin-right: var(--space-4);
}

.hamburger-line {
    width: 100%;
    height: 2px;
    background-color: var(--text-primary);
    border-radius: var(--radius-full);
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--fs-sm);
    color: var(--text-secondary);
}

.crumb-current {
    font-weight: var(--fw-semibold);
    color: var(--text-primary);
}

.search-bar {
    display: flex;
    align-items: center;
    background-color: var(--bg-input);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-full);
    width: 300px;
    border: 1px solid transparent;
    transition: all var(--duration-fast);
}

.search-bar:focus-within {
    border-color: var(--brand-500);
    box-shadow: 0 0 0 2px var(--brand-100);
}

.search-bar input {
    border: none;
    background: none;
    margin-left: var(--space-2);
    outline: none;
    width: 100%;
    font-size: var(--fs-sm);
    color: var(--text-primary);
}

/* Scrollable Settings Area */
.scroll-container {
    flex: 1;
    overflow-y: auto;
    padding: var(--space-8);
    padding-bottom: var(--space-16);
}

.content-wrapper {
    max-width: 800px;
    margin: 0 auto;
}

.section-title {
    font-size: var(--fs-3xl);
    font-weight: var(--fw-bold);
    margin-bottom: var(--space-2);
    color: var(--text-primary);
}

.section-desc {
    color: var(--text-secondary);
    margin-bottom: var(--space-8);
    font-size: var(--fs-lg);
}

/* =========================================
   3. COMPONENTS
   ========================================= */

/* Card Groups */
.card-group {
    background-color: var(--bg-card);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-sm);
    overflow: hidden;
    margin-bottom: var(--space-6);
    border: 1px solid var(--border-subtle);
}

.setting-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-5) var(--space-6);
    transition: background-color var(--duration-fast);
}

.setting-row:hover {
    background-color: var(--bg-card-hover);
}

.divider {
    height: 1px;
    background-color: var(--border-subtle);
    margin: 0 var(--space-6);
}

.setting-info h3 {
    font-size: var(--fs-base);
    font-weight: var(--fw-medium);
    margin-bottom: var(--space-1);
    color: var(--text-primary);
}

.setting-info p {
    font-size: var(--fs-sm);
    color: var(--text-secondary);
}

/* Toggle Switch */
.switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 28px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--switch-bg-off);
    transition: .4s var(--ease-bounce);
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 22px;
    width: 22px;
    left: 3px;
    bottom: 3px;
    background-color: var(--switch-knob);
    transition: .4s var(--ease-bounce);
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

input:checked+.slider {
    background-color: var(--switch-bg-on);
}

input:checked+.slider:before {
    transform: translateX(22px);
}

input:focus+.slider {
    box-shadow: 0 0 1px var(--brand-500);
}

/* Footer */
.app-footer {
    text-align: center;
    margin-top: var(--space-12);
    color: var(--text-tertiary);
    font-size: var(--fs-xs);
}

/* =========================================
   4. RESPONSIVE DESIGN
   ========================================= */

/* Tablet & Mobile */
@media (max-width: 1024px) {
    .sidebar {
        position: absolute;
        bottom: 0px;
        top: 0px;
        left: 0;
        height: 100vh;
        transform: translateX(-100%);
        /* Hide by default */
        box-shadow: var(--shadow-lg);
    }

    .sidebar.open {
        transform: translateX(0);
    }

    .mobile-menu-toggle {
        display: flex;
    }

    .top-bar {
        padding: 0 var(--space-4);
    }

    .scroll-container {
        padding: var(--space-4);
    }
}

/* Mobile specific */
@media (max-width: 640px) {
    .search-bar {
        display: none;
        /* Simplify UI for mobile */
    }

    .breadcrumbs {
        display: none;
    }

    .top-bar {
        justify-content: flex-start;
    }

    /* Reveal title in center mobile */
    .top-bar::after {
        content: "System Settings";
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        font-weight: var(--fw-bold);
        color: var(--text-primary);
    }

    /* Close previous media query */
}

/* =========================================
   5. PREMIUM ENHANCEMENTS & OVERLAYS
   ========================================= */

/* Glassmorphism Sidebar */
.sidebar {
    background-color: var(--bg-sidebar);
    /* Fallback */
}

@supports (backdrop-filter: blur(10px)) {
    .sidebar {
        background-color: var(--bg-sidebar);
        /* In a real scenario we'd use RGBA vars, but for now let's just add the blur to the top bar */
    }

    .top-bar {
        background-color: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        position: sticky;
        top: 0;
        z-index: 50;
        border-bottom: 1px solid var(--border-subtle);
    }

    [data-theme="dark"] .top-bar {
        background-color: rgba(15, 23, 42, 0.7);
    }
}

/* Custom Range Slider */
input[type=range] {
    -webkit-appearance: none;
    width: 100%;
    background: transparent;
}

input[type=range]:focus {
    outline: none;
}

/* Thumb */
input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    height: 20px;
    width: 20px;
    border-radius: 50%;
    background: #ffffff;
    cursor: pointer;
    margin-top: -8px;
    /* You need to specify a margin in Chrome, but in Firefox and IE it is automatic */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(0, 0, 0, 0.05);
    /* Subtle border */
    transition: transform var(--duration-fast);
}

input[type=range]::-webkit-slider-thumb:hover {
    transform: scale(1.1);
}

/* Track */
input[type=range]::-webkit-slider-runnable-track {
    width: 100%;
    height: 4px;
    cursor: pointer;
    background: var(--slate-300);
    border-radius: var(--radius-full);
    transition: background var(--duration-fast);
}

[data-theme="dark"] input[type=range]::-webkit-slider-runnable-track {
    background: var(--slate-600);
}

/* Fill effect (Simulated with simple gradient or JS, but for vanilla CSS we can just color the track active state lightly if supported, or rely on JS to update background gradient. 
   For this specific request, we'll keep it simple sleek track.)
*/

input[type=range]:focus::-webkit-slider-runnable-track {
    background: var(--brand-300);
}

/* Brightness / Volume HUD Overlay */
.hud-overlay {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.9);
    width: 160px;
    height: 160px;
    background-color: rgba(240, 240, 240, 0.9);
    /* Light mode glass */
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 24px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
    z-index: 1000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease, transform 0.2s ease;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.hud-overlay.visible {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
}

[data-theme="dark"] .hud-overlay {
    background-color: rgba(30, 41, 59, 0.85);
    /* Dark mode glass */
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.hud-icon {
    font-size: 48px;
    color: var(--text-primary);
    margin-bottom: 16px;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.hud-bar-container {
    width: 80%;
    height: 6px;
    background-color: var(--slate-300);
    border-radius: var(--radius-full);
    overflow: hidden;
}

[data-theme="dark"] .hud-bar-container {
    background-color: var(--slate-600);
}

.hud-bar-fill {
    height: 100%;
    background-color: var(--brand-500);
    width: 50%;
    /* JS will update this */
    transition: width 0.1s linear;
}

/* =========================================
   6. FEATURE STYLES (Storage & Wallpaper)
   ========================================= */

/* Column Layout for complex items */
.setting-row.column-layout {
    flex-direction: column;
    align-items: flex-start;
}

/* Storage Bar */
.storage-track {
    width: 100%;
    height: 16px;
    background-color: var(--slate-200);
    border-radius: var(--radius-full);
    overflow: hidden;
    margin-bottom: var(--space-3);
}

[data-theme="dark"] .storage-track {
    background-color: var(--slate-700);
}

.storage-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--brand-500), var(--brand-300));
    border-radius: var(--radius-full);
    position: relative;
}

/* Multi-colored segments simulated with box-shadow or simplified gradient for now */
.storage-legend {
    display: flex;
    gap: var(--space-4);
    font-size: var(--fs-xs);
    color: var(--text-secondary);
}

.legend-item {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
}

.dot.apps {
    background-color: var(--brand-500);
}

.dot.media {
    background-color: var(--warning-500);
}

.dot.system {
    background-color: var(--slate-400);
}


/* Wallpaper Picker */
.wallpaper-grid {
    display: flex;
    gap: var(--space-3);
    flex-wrap: wrap;
    width: 100%;
}

.wallpaper-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-2);
    cursor: pointer;
    transition: transform var(--duration-fast);
}

.wallpaper-option:hover {
    transform: translateY(-2px);
}

.wallpaper-option .preview {
    width: 60px;
    height: 60px;
    border-radius: var(--radius-lg);
    border: 2px solid transparent;
    box-shadow: var(--shadow-sm);
}

.wallpaper-option.selected .preview {
    border-color: var(--brand-500);
    box-shadow: 0 0 0 2px var(--brand-100);
}

.wallpaper-option .label {
    font-size: var(--fs-xs);
    color: var(--text-secondary);
}

/* Wallpaper Previews */
.preview.default {
    background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
}

.preview.ocean {
    background: linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%);
}

.preview.sunset {
    background: linear-gradient(135deg, #f97316 0%, #ef4444 100%);
}

.preview.forest {
    background: linear-gradient(135deg, #22c55e 0%, #15803d 100%);
}

.preview.midnight {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
}

/* Dynamic Backgrounds on Body based on wallpaper state (handled via data-wallpaper on body) */
body[data-wallpaper="ocean"] {
    background-image: linear-gradient(to bottom right, #e0f2fe, #bfdbfe);
}

body[data-wallpaper="sunset"] {
    background-image: linear-gradient(to bottom right, #ffedd5, #fed7aa);
}

body[data-wallpaper="forest"] {
    background-image: linear-gradient(to bottom right, #dcfce7, #bbf7d0);
}

body[data-wallpaper="midnight"] {
    background-image: linear-gradient(to bottom right, #1e293b, #000000);
    color: white;
}

/* System Update */
.update-actions {
    display: flex;
    align-items: center;
    gap: var(--space-4);
}

.btn-primary {
    background-color: var(--brand-600);
    color: white;
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius-md);
    font-weight: var(--fw-medium);
    font-size: var(--fs-sm);
    transition: background-color var(--duration-fast);
}

.btn-primary:hover:not(:disabled) {
    background-color: var(--brand-700);
}

.btn-primary:disabled {
    opacity: 0.7;
    cursor: default;
}

.spinner {
    width: 20px;
    height: 20px;
    border: 2px solid var(--slate-300);
    border-top-color: var(--brand-500);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

.spinner.hidden {
    display: none;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* =========================================
   7. UI 2.0 ANIMATIONS
   ========================================= */

/* Nav Icon Animation */
.nav-item:hover .nav-icon {
    transform: scale(1.1) rotate(5deg);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.nav-item.active .nav-icon {
    transform: scale(1.1);
}

/* Card Hover Depth */
.setting-row:hover {
    transform: translateX(4px);
    border-radius: var(--radius-lg);
    /* Ensure rounded corners on hover if not already */
}

/* Button Pulse on click */
.btn-primary:active {
    transform: scale(0.96);
}

/* Smooth Page Transition override */
.settings-section {
    animation: fadeInSlide 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes fadeInSlide {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}